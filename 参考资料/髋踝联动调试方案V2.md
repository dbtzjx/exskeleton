# 髋踝联动调试方案V2

之前运动控制采用正弦运动模式，位置环控制，没有系统考虑康复的需求，康复病人的需求并不是完全被动的，而是根据不同程度的失能来进行辅助，需要分阶段，不能做成完全刚性的控制。

## 控制原则

将肢体柔和的送到指定位置，遇到强阻力要有一定的柔性。

整体控制要柔和，不能像机器人一样带着病人动。

辅助强度要能调节，按照不同阶段康复需求，患者主动性越强，辅助强度越弱。

在之前摸索的基础上，了解了康复的基本原理，接下来拟定一些框架性的软件功能,，用来配合康复临床的使用。

开发环境转移到cursor上面，系统性的规划。

# 软件架构

根据康复的不同阶段，分为不同的使用模式。

早期模式：

由于患者存在神经通路不通以及肌无力的情况，主要采用被动恢复模式。

控制上以位置模式为主，采用**标准的步态**，对患者进行柔和的运动引导。这个阶段时间比较短。

接下来要减弱被动模式的控制力度，以激发患者主动性为主，**模拟健侧腿的运动模式**进行训练，避免人机对抗，允许误差存在。

主动康复阶段：

主要采用力矩模式进行控制。需要**感知患者意图**，适时按比例提供助力。

髋踝联动时，学习患者健侧腿步态进行模拟，但也不能强制患者完全跟随预设轨迹，否则会抑制主动性。

**混合控制策略**，在关键相位上，需要给与更多的主力，协助患者完成动作，比如中风后，踝关节无法完成屈伸，以至于拖在地上走，这时候就要先保证患者完成动作，避免过度代偿。

控制的颗粒度要细，**根据不同的动作阶段设置不同的控制策略**。

硬件采用teensy4.1，使用platformio编译

**髋关节电机 (ID 1)**：比例为 **1° = 3600 单位**。

**踝关节电机 (ID 2)**：比例为 **1° = 1000 单位**。